name: Create Release Branch
on:
  workflow_dispatch:
jobs:
  create-release:
    runs-on: ubuntu-latest

    steps:
      - name: Check out code
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GH_WORKFLOW_TOKEN }}
      - name: Get current time
        id: release
        run: echo "name=$(date +'%Y-%m-%d_%H-%M')" >> $GITHUB_OUTPUT
      - name: Show current time
        run: echo "Current time is ${{ steps.release.outputs.name }}"
      - name: Create release branch
        run: git checkout -b release/${{ steps.release.outputs.name }}
      - name: Push new branch
        run: git push origin release/${{ steps.release.outputs.name }}
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          branch: release/${{ steps.release.outputs.name }}
          base: main
          title: "Release: ${{ steps.release.outputs.name }}"
          body: |
            :exclamation: Before merging please check release workflow and ensure acceptance tests are :green_apple: :exclamation:
            [Release worflow ](${{ github.server_url }}/${{ github.repository }}/actions/workflows/release.yml)
